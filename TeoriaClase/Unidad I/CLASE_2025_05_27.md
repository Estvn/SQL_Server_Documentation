
# REVOKE

- REVOKE es para revocar privilegios a un usuario o un rol en la base de datos.

```
REVOKE {PERMISO} ON {OBJETO} FROM {USUARIO | ROL} GO
```

- Al crear un usuario o rol, desde el inicio no tiene privilegios asignados para manipular objetos en la base de datos.

```
GRANT ALL PRIVILEGES TO ADMIN_USR GO
GRANT DELETE ON DBO.TABLE1 TO ADMIN_USR GO
```

Quitar un privilegio a un usuario

```
REVOKE SELECT ON DBO.TABLE1 TO ADMIN_USR GO
REVOKE DELETE TO ADMIN_USR GO
```

- Si un usuario tiene privilegios de SELECT y está en un rol con privilegios de SELECT, entonces tiene los privilegios de SELECT duplicados (no es ningún error).
- Pero si al usuario se le quitan los privilegios de SELECT, pero aún está en el rol con los privilegios de SELECT, entonces podrá seguir realizando SELECT sin restricciones.

- Las dos soluciones son:
	1. Quitar los privilegios de SELECT en el rol
	2. Eliminar al usuario del rol que tiene los privilegios de SELECT

- **GRANT y REVOKE manipulan los privilegios para comandos DDL y DML.**

```
GRANT ALL PRIVILEGES TO USUARIO GO
REVOKE ALL PRIVILEGES TO USUARIO GO
```

# Encriptación de Datos en Bases de Datos

- Es una práctica fundamental para resguardar la seguridad y confidencialidad de los datos.

- La encriptación cumple con los siguientes propósitos:
	1.  **Confidencialidad.** La encriptación convierte los datos en caracteres ilegibles para aquellos que no tienen la clave de desencriptación.
	2. **Cumplimiento normativo.** Las regulaciones y leyes requieren que los datos se mantengan seguros y protegidos. 
	3. **Protección contra amenazas externas.** 
	4. **Protección contra la pérdida o robo de medios.**
	5. **Integridad de los datos.**

## Ejemplo básico de la encriptación de los datos

- Este ejemplo tiene el propósito de ser usado en la encriptación a nivel de los campos de las tablas de la base de datos.

- Todas las variables en SQL Server se declaran con un arroba "@" antes del nombre de la variable.

- **Clave asimétrica.** Utiliza una llave pública y una privada para la encriptación y desencriptación del contenido que se envía.
- **Clave simétrica.** Un texto pasa por un proceso de encriptación, y usa una clave para desencriptarlo. **La misma clave para la encriptación es la misma usada para la desencriptación.**

```
DECLARE @tarjeta VARCHAR(100) = '1234567890';
DECLARE @clave VARCHAR(100) = 'Honduras';
DECLARE @textoEncriptado varbinary(1000);

SET @textoEncriptado = ENCRYPTBYPHRASE(@clave, @tarjeta);

SELECT @tarjeta as VALOR_CLARO, @textoEncriptado as VALOR_ENCRIPTADO;

DECLARE @valorClaro varchar(100);
SET @valorClaro = CAST(DESCRYPTBYPASSPHRASE(@clave, @tarjeta)) AS VARCHAR(100);

SELECT @textoEncriptado valor_encriptado, @valor_claro valor_claro;
```






























